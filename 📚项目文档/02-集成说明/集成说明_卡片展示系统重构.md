# 卡片展示系统重构 - 集成说明

## 修改概述

本次更新实现了"杀戮尖塔"风格的卡牌交互系统,用于在可视化演示模式中展示非遗项目。

## 功能特性

### 1. 卡牌手牌布局

- ✅ **点击城市区域**:在ECharts地图上点击城市区域,会在屏幕底部展示该城市所有非遗项目的卡片
- ✅ **重叠排列**:卡片以重叠方式排列在窗口底部,每张卡片仅露出80px宽度
- ✅ **渐变背景**:每张卡片根据项目名称生成独特的HSL渐变色背景

### 2. 交互流程

```
第一次点击卡片 → 选中状态(金色边框,移动到手牌中央,抬高40px)
    ↓
第二次点击卡片 → 跳转到屏幕中央展示完整详情(原有的ich-card样式)
```

### 3. 视觉优化

- ❌ **移除了**:贯穿屏幕的红色边框
- ✅ **新增了**:深色半透明覆盖层(rgba(0, 0, 0, 0.85))
- ✅ **新增了**:卡片悬停效果(抬高30px + 蓝色光晕)
- ✅ **新增了**:选中效果(金色边框 + 抬高40px)

## 修改文件清单

### 1. `VisualWeb/css/cards.css`

**修改内容**:

- 修改`.card-overlay`样式,调整背景和布局方向
- 新增`.card-hand`容器样式
- 新增`.hand-card`及相关手牌卡片样式
- 新增`.hand-card.selected`选中状态样式

### 2. `VisualWeb/js/main.js`

**修改内容**:

- 在`renderMap`函数中添加地图区域点击监听(`chart.on('click', 'geo')`)
- 新增`showCityCards(cityName)`函数 - 渲染卡牌手牌
- 新增`handleHandCardClick(cardElement)`函数 - 处理卡片点击交互
- 新增全局变量`selectedCard`用于跟踪当前选中的卡片

## 数据流程

1. **地图点击** → `chart.on('click', 'geo')` 捕获城市名称
2. **筛选数据** → `mapPoints.filter()` 根据城市名称过滤非遗项目
3. **渲染手牌** → 动态生成HTML并计算卡片位置
4. **第一次点击** → 添加`selected`类,移动到中央
5. **第二次点击** → 调用`showDetail()`显示完整详情

## 测试建议

### 手动测试步骤

1. 打开Web可视化模式(点击"WEB"按钮)
2. 等待地图加载完成
3. **点击任意城市区域**(例如"济南市"的面要素)
4. 验证卡片是否在底部以重叠方式显示
5. **鼠标悬停**在卡片上,验证是否有抬升和光晕效果
6. **点击一张卡片**,验证是否变为金色边框并移动到中央
7. **再次点击同一张卡片**,验证是否跳转到全屏详情视图
8. 点击关闭按钮,验证覆盖层是否正常关闭

### 已知兼容性说明

- CSS使用了`-webkit-line-clamp`,在现代浏览器中支持良好
- 动画使用`cubic-bezier`缓动函数,IE11以下不支持

## 后续优化建议

- [ ] 添加卡片拖拽排序功能
- [ ] 优化卡片图片加载(懒加载或占位符)
- [ ] 添加卡片筛选/搜索功能
- [ ] 支持键盘导航(左右箭头切换卡片)

---

**修改日期**: 2026-01-13  
**修改人**: Agent (通用辅助)  
**角色定位**: Member E (可视化演示模块)
